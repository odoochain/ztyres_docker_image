<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>


        <record id="sale_approve.tree_picking_form_inherit_stock" model="ir.ui.view">
            <field name="name">stock.picking.tree</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.vpicktree" />
            <field name="arch" type="xml">
                <xpath expr="//tree/field[@name='partner_id']" position="after">
                    <field name="shipment_state" attrs="{'invisible':['|',('sale_is_set','!=',True), ('state', 'not in', ('sale','done','assigned'))]}"/>
                    <field name="sale_is_set" invisible="1"/>                    
                </xpath>

                <xpath expr="//tree" position="attributes">
                    <attribute name="decoration-info">shipment_state == 'draft' and state in ['assigned'] and sale_is_set == True</attribute>
                    <attribute name="decoration-success">shipment_state == 'done' and state in ['assigned','done']</attribute>
                </xpath>
            </field>
        </record>

        <record id="sale_approve.view_picking_form_inherit_stock" model="ir.ui.view">
            <field name="name">stock.picking.form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form" />
            <field name="arch" type="xml">
                <field name='name' position='before'>
                    <field name='sale_is_set' invisible="1" />
                </field>
                <xpath expr="/form/header[last()]" position="after">
                    <header>
                        <field name="shipment_state" widget="statusbar" attrs="{'invisible':['|',('sale_is_set','!=',True), ('state', 'not in', ('sale','done','assigned'))]}" />
                    </header>
                </xpath>
            </field>
        </record>


    </data>
</odoo>